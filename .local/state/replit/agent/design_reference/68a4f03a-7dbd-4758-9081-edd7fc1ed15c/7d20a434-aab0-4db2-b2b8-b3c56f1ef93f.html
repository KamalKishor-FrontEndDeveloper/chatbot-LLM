<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthLantern AI Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
    tailwind.config = {
        theme: {
            extend: {
                borderRadius: {
                    lg: "var(--radius)",
                    md: "calc(var(--radius) - 2px)",
                    sm: "calc(var(--radius) - 4px)",
                },
                colors: {
                    background: "var(--background)",
                    foreground: "var(--foreground)",
                    card: {
                        DEFAULT: "var(--card)",
                        foreground: "var(--card-foreground)",
                    },
                    popover: {
                        DEFAULT: "var(--popover)",
                        foreground: "var(--popover-foreground)",
                    },
                    primary: {
                        DEFAULT: "var(--primary)",
                        foreground: "var(--primary-foreground)",
                    },
                    secondary: {
                        DEFAULT: "var(--secondary)",
                        foreground: "var(--secondary-foreground)",
                    },
                    muted: {
                        DEFAULT: "var(--muted)",
                        foreground: "var(--muted-foreground)",
                    },
                    accent: {
                        DEFAULT: "var(--accent)",
                        foreground: "var(--accent-foreground)",
                    },
                    destructive: {
                        DEFAULT: "var(--destructive)",
                        foreground: "var(--destructive-foreground)",
                    },
                    border: "var(--border)",
                    input: "var(--input)",
                    ring: "var(--ring)",
                },
                fontFamily: {
                    sans: ["Inter", "system-ui", "sans-serif"],
                }
            },
        }
    };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --background: hsl(210 40% 98%);
            --foreground: hsl(222.2 84% 4.9%);
            --card: hsl(0 0% 100%);
            --card-foreground: hsl(222.2 84% 4.9%);
            --popover: hsl(0 0% 100%);
            --popover-foreground: hsl(222.2 84% 4.9%);
            --primary: hsl(221.2 83.2% 53.3%);
            --primary-foreground: hsl(210 40% 98%);
            --secondary: hsl(142.1 76.2% 36.3%);
            --secondary-foreground: hsl(355.7 100% 97.3%);
            --muted: hsl(210 40% 96%);
            --muted-foreground: hsl(215.4 16.3% 46.9%);
            --accent: hsl(48 96% 53%);
            --accent-foreground: hsl(222.2 84% 4.9%);
            --destructive: hsl(0 84.2% 60.2%);
            --destructive-foreground: hsl(210 40% 98%);
            --border: hsl(214.3 31.8% 91.4%);
            --input: hsl(214.3 31.8% 91.4%);
            --ring: hsl(221.2 83.2% 53.3%);
            --radius: 0.75rem;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: hsl(var(--muted-foreground));
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
            30% { transform: translateY(-10px); opacity: 1; }
        }

        .message-fade-in {
            animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-container {
            height: calc(100vh - 140px);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: hsl(var(--muted)) transparent;
        }

        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: hsl(var(--muted));
            border-radius: 3px;
        }

        .treatment-card {
            transition: all 0.2s ease;
        }

        .treatment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .pulse-ring {
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.33); }
            80%, 100% { opacity: 0; }
        }
    </style>
</head>
<body class="bg-background font-sans antialiased">
    <!-- Header -->
    <header class="bg-card border-b border-border sticky top-0 z-50 backdrop-blur-sm bg-opacity-95">
        <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center">
                    <i class="fas fa-stethoscope text-primary-foreground text-lg"></i>
                </div>
                <div>
                    <h1 class="text-xl font-semibold text-foreground">HealthLantern AI</h1>
                    <p class="text-sm text-muted-foreground">Your Healthcare Assistant</p>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <div class="flex items-center space-x-1 text-secondary">
                    <div class="w-2 h-2 bg-secondary rounded-full pulse-ring"></div>
                    <span class="text-sm font-medium">Live</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Chat Container -->
    <main class="max-w-4xl mx-auto px-4 py-6">
        <!-- Welcome Message -->
        <div class="text-center mb-8" data-mock="true">
            <div class="inline-flex items-center space-x-2 bg-muted px-4 py-2 rounded-full text-sm text-muted-foreground mb-4">
                <i class="fas fa-robot text-primary"></i>
                <span>Powered by OpenAI & CopilotKit</span>
            </div>
            <h2 class="text-2xl font-bold text-foreground mb-2">How can I help you today?</h2>
            <p class="text-muted-foreground max-w-2xl mx-auto">
                Ask me about treatment costs, available services, doctor availability, or any healthcare-related questions.
            </p>
        </div>

        <!-- Suggested Queries -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-8" data-mock="true">
            <!-- @COMPONENT: SuggestedQuery -->
            <button class="bg-card border border-border hover:border-primary/50 rounded-lg p-4 text-left transition-all duration-200 hover:shadow-md group">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center group-hover:bg-primary/20 transition-colors">
                        <i class="fas fa-dollar-sign text-primary text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-foreground text-sm">Treatment Costs</p>
                        <p class="text-xs text-muted-foreground mt-1">"What is the cost of facelift?"</p>
                    </div>
                </div>
            </button>
            <!-- @END_COMPONENT: SuggestedQuery -->

            <!-- @COMPONENT: SuggestedQuery -->
            <button class="bg-card border border-border hover:border-secondary/50 rounded-lg p-4 text-left transition-all duration-200 hover:shadow-md group">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-secondary/10 rounded-lg flex items-center justify-center group-hover:bg-secondary/20 transition-colors">
                        <i class="fas fa-list-ul text-secondary text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-foreground text-sm">Service Lists</p>
                        <p class="text-xs text-muted-foreground mt-1">"Show me all available treatments"</p>
                    </div>
                </div>
            </button>
            <!-- @END_COMPONENT: SuggestedQuery -->

            <!-- @COMPONENT: SuggestedQuery -->
            <button class="bg-card border border-border hover:border-accent/50 rounded-lg p-4 text-left transition-all duration-200 hover:shadow-md group">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent/10 rounded-lg flex items-center justify-center group-hover:bg-accent/20 transition-colors">
                        <i class="fas fa-user-md text-accent text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-foreground text-sm">Doctor Info</p>
                        <p class="text-xs text-muted-foreground mt-1">"Which doctors perform hair transplants?"</p>
                    </div>
                </div>
            </button>
            <!-- @END_COMPONENT: SuggestedQuery -->
        </div>

        <!-- Chat Messages Container -->
        <div class="chat-container space-y-4" id="chatContainer">
            
            <!-- Sample User Message -->
            <!-- @COMPONENT: UserMessage -->
            <div class="flex justify-end" data-mock="true">
                <div class="max-w-xs lg:max-w-md bg-primary text-primary-foreground rounded-2xl rounded-br-md px-4 py-3 message-fade-in">
                    <p class="text-sm">What is the cost of facelift treatment?</p>
                    <span class="text-xs opacity-75 mt-1 block">2:34 PM</span>
                </div>
            </div>
            <!-- @END_COMPONENT: UserMessage -->

            <!-- Sample Assistant Message with Treatment Cards -->
            <!-- @COMPONENT: AssistantMessage -->
            <div class="flex items-start space-x-3 message-fade-in" data-mock="true">
                <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-robot text-primary-foreground text-sm"></i>
                </div>
                <div class="flex-1 max-w-2xl">
                    <div class="bg-card border border-border rounded-2xl rounded-tl-md px-4 py-3 shadow-sm">
                        <div class="prose prose-sm max-w-none">
                            <p class="text-foreground mb-3">I found information about facelift treatments in our system. Here are the available options:</p>
                            
                            <!-- Treatment Cards -->
                            <div class="space-y-3 mt-4">
                                <!-- @COMPONENT: TreatmentCard -->
                                <div class="treatment-card bg-muted/30 border border-border rounded-lg p-4">
                                    <div class="flex items-start justify-between">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2 mb-2">
                                                <h4 class="font-semibold text-foreground">Face Lift</h4>
                                                <span class="bg-secondary/10 text-secondary text-xs px-2 py-1 rounded-full">Treatment</span>
                                            </div>
                                            <p class="text-sm text-muted-foreground mb-3">Plastic Surgery category</p>
                                            <div class="flex items-center space-x-4 text-sm">
                                                <div class="flex items-center space-x-1">
                                                    <i class="fas fa-user-md text-primary text-xs"></i>
                                                    <span class="text-muted-foreground">1 Doctor Available</span>
                                                </div>
                                                <div class="flex items-center space-x-1">
                                                    <i class="fas fa-info-circle text-accent text-xs"></i>
                                                    <span class="text-muted-foreground">ID: 19451</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <p class="text-sm text-muted-foreground">Price</p>
                                            <p class="text-lg font-bold text-primary">Contact for Quote</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- @END_COMPONENT: TreatmentCard -->
                            </div>

                            <!-- Additional Info -->
                            <div class="mt-4 p-3 bg-secondary/5 border border-secondary/20 rounded-lg">
                                <div class="flex items-start space-x-2">
                                    <i class="fas fa-lightbulb text-secondary text-sm mt-0.5"></i>
                                    <div class="text-sm">
                                        <p class="font-medium text-foreground">Need more information?</p>
                                        <p class="text-muted-foreground">You can ask about specific doctors, compare treatments, or inquire about consultation booking.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <span class="text-xs text-muted-foreground mt-2 block">2:34 PM</span>
                    </div>
                </div>
            </div>
            <!-- @END_COMPONENT: AssistantMessage -->

            <!-- Loading Message (Hidden by default) -->
            <!-- @COMPONENT: LoadingMessage -->
            <div class="flex items-start space-x-3 hidden" id="loadingMessage">
                <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-robot text-primary-foreground text-sm"></i>
                </div>
                <div class="bg-card border border-border rounded-2xl rounded-tl-md px-4 py-3 shadow-sm">
                    <div class="flex items-center space-x-2">
                        <span class="text-sm text-muted-foreground">AI is thinking</span>
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- @END_COMPONENT: LoadingMessage -->

        </div>
    </main>

    <!-- Input Area -->
    <div class="sticky bottom-0 bg-background/95 backdrop-blur-sm border-t border-border">
        <div class="max-w-4xl mx-auto px-4 py-4">
            <!-- @COMPONENT: ChatInput -->
            <div class="flex items-end space-x-3">
                <div class="flex-1 relative">
                    <textarea 
                        id="messageInput"
                        placeholder="Ask about treatments, costs, doctors, or any healthcare question..."
                        class="w-full bg-card border border-border rounded-2xl px-4 py-3 pr-12 text-foreground placeholder-muted-foreground resize-none focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent transition-all duration-200 min-h-[48px] max-h-32"
                        rows="1"
                        data-implementation="Should auto-resize based on content, integrate with CopilotKit for suggestions"
                    ></textarea>
                    <button 
                        id="sendButton"
                        class="absolute right-2 bottom-2 w-8 h-8 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg flex items-center justify-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                        data-event="click:handleSendMessage"
                        data-implementation="Should validate input, trigger API call, show loading state"
                    >
                        <i class="fas fa-paper-plane text-sm"></i>
                    </button>
                </div>
                
                <!-- Voice Input Button -->
                <button 
                    id="voiceButton"
                    class="w-12 h-12 bg-secondary hover:bg-secondary/90 text-secondary-foreground rounded-xl flex items-center justify-center transition-colors duration-200"
                    data-implementation="Should integrate with speech recognition API"
                >
                    <i class="fas fa-microphone"></i>
                </button>
            </div>
            <!-- @END_COMPONENT: ChatInput -->

            <!-- API Status Indicator -->
            <div class="flex items-center justify-center mt-3 space-x-4 text-xs text-muted-foreground">
                <div class="flex items-center space-x-1">
                    <div class="w-2 h-2 bg-secondary rounded-full"></div>
                    <span>HealthLantern API Connected</span>
                </div>
                <div class="flex items-center space-x-1">
                    <div class="w-2 h-2 bg-primary rounded-full"></div>
                    <span>OpenAI Integration Active</span>
                </div>
                <div class="flex items-center space-x-1">
                    <div class="w-2 h-2 bg-accent rounded-full"></div>
                    <span>CopilotKit Ready</span>
                </div>
            </div>
        </div>
    </div>

    <script>
    (function() {
        // TODO: Initialize CopilotKit integration
        // TODO: Set up OpenAI API integration
        // TODO: Configure real-time API connection to HealthLantern

        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const chatContainer = document.getElementById('chatContainer');
        const loadingMessage = document.getElementById('loadingMessage');
        const voiceButton = document.getElementById('voiceButton');

        // Auto-resize textarea
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 128) + 'px';
        });

        // Handle Enter key (without Shift)
        messageInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                handleSendMessage();
            }
        });

        // Send button click handler
        sendButton.addEventListener('click', handleSendMessage);

        // Suggested query handlers
        document.querySelectorAll('.grid button').forEach(button => {
            button.addEventListener('click', function() {
                const queryText = this.querySelector('.text-xs').textContent.replace(/['"]/g, '');
                messageInput.value = queryText;
                handleSendMessage();
            });
        });

        function handleSendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message to chat
            addUserMessage(message);
            
            // Clear input and show loading
            messageInput.value = '';
            messageInput.style.height = 'auto';
            showLoading();

            // TODO: Implement actual API integration
            // This would integrate with:
            // 1. CopilotKit for conversation management
            // 2. OpenAI API for natural language processing
            // 3. HealthLantern API for treatment data
            
            // Simulate API response (replace with real implementation)
            setTimeout(() => {
                hideLoading();
                simulateAIResponse(message);
            }, 2000);
        }

        function addUserMessage(message) {
            const userMessageHTML = `
                <div class="flex justify-end message-fade-in">
                    <div class="max-w-xs lg:max-w-md bg-primary text-primary-foreground rounded-2xl rounded-br-md px-4 py-3">
                        <p class="text-sm">${escapeHtml(message)}</p>
                        <span class="text-xs opacity-75 mt-1 block">${getCurrentTime()}</span>
                    </div>
                </div>
            `;
            chatContainer.insertAdjacentHTML('beforeend', userMessageHTML);
            scrollToBottom();
        }

        function showLoading() {
            loadingMessage.classList.remove('hidden');
            scrollToBottom();
        }

        function hideLoading() {
            loadingMessage.classList.add('hidden');
        }

        function simulateAIResponse(userMessage) {
            // TODO: Replace with actual CopilotKit + OpenAI + HealthLantern API integration
            const responseHTML = `
                <div class="flex items-start space-x-3 message-fade-in">
                    <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center flex-shrink-0 mt-1">
                        <i class="fas fa-robot text-primary-foreground text-sm"></i>
                    </div>
                    <div class="flex-1 max-w-2xl">
                        <div class="bg-card border border-border rounded-2xl rounded-tl-md px-4 py-3 shadow-sm">
                            <p class="text-foreground text-sm">I understand you're asking about "${escapeHtml(userMessage)}". Let me search our treatment database and provide you with the most relevant information...</p>
                            <span class="text-xs text-muted-foreground mt-2 block">${getCurrentTime()}</span>
                        </div>
                    </div>
                </div>
            `;
            chatContainer.insertAdjacentHTML('beforeend', responseHTML);
            scrollToBottom();
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function getCurrentTime() {
            return new Date().toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Voice input handler (placeholder)
        voiceButton.addEventListener('click', function() {
            // TODO: Implement speech recognition integration
            console.log('Voice input would be implemented here');
        });

        // Initialize chat with welcome state
        scrollToBottom();
    })();
    </script>

    <!-- 
    @FUNCTIONALITY: This CopilotKit conversational interface should implement:
    
    1. CopilotKit Integration:
       - Import and configure CopilotKit SDK
       - Set up conversation context and memory
       - Handle real-time conversation flow
    
    2. OpenAI Integration:
       - Configure OpenAI API with appropriate prompts
       - Parse healthcare queries and intent recognition
       - Generate contextual responses based on treatment data
    
    3. HealthLantern API Integration:
       - Fetch treatment data from provided API endpoint
       - Parse hierarchical treatment structure
       - Match user queries to relevant treatments/doctors
       - Handle real-time data updates
    
    4. Advanced Features:
       - Natural language query processing
       - Treatment recommendation engine
       - Doctor availability checking
       - Cost estimation and comparison
       - Appointment booking integration
       - Error handling and fallback responses
    
    5. Real-time Capabilities:
       - WebSocket connection for live updates
       - Streaming responses for better UX
       - Conversation context persistence
       - Multi-turn dialogue support
    -->
</body>
</html>